# Компилиция/интерпретация

JavaScript является комбинацией интерпретируемого и компилируемого языка программирования, и его выполнение происходит в веб-браузерах или на сервере с использованием среды выполнения например, такой как Node.js.

Можно выделить следущие шаги:

1. **_Парсинг (Разбор)_**. Браузер получает исходный код JavaScript. Происходит фаза парсинга, в которой исходный код разбирается на **_токены_** (лексический анализ) и строится **_синтаксическое дерево_** (синтаксический анализ).

2. **_Интерпретация_**. Интерпретатор браузера (или движок JavaScript, например, V8 для Chrome) выполняет код, который создается на этапе парсинга. Интерпретатор пошагово выполняет инструкции кода, преобразуя их в машинный код.
Компиляция в байт-код (не всегда):

- Некоторые движки JavaScript, такие как V8, используют дополнительный этап компиляции в промежуточный байт-код перед выполнением машинного кода. Этот байт-код сохраняется для повторного использования и повышения производительности.
Оптимизация (не всегда):

- Некоторые движки JavaScript проводят оптимизацию кода во время выполнения, адаптируясь к особенностям исполняемого кода.
Происходят оптимизации, такие как инлайнинг функций, разворачивание циклов и т. д.

3. **_Выполнение_**. Скомпилированный или интерпретированный код выполняется в соответствии с порядком указанным в исходном коде. В процессе выполнения кода могут возникнуть события, такие как вызов функций, обработка событий, изменение DOM и т. д.

4. **_Сборка мусора_**. В процессе выполнения JavaScript среда управляет памятью, освобождая ресурсы, которые больше не используются. Сборщик мусора удаляет объекты, на которые нет ссылок, освобождая память.

5. **_Обработка ошибок_**. В случае ошибок, интерпретатор генерирует исключения.
Обработчики ошибок могут быть установлены для предотвращения аварийного завершения выполнения программы.

6. **_Окончание выполнения_**. Выполнение программы завершается, когда весь код выполнен или когда происходит завершение выполнения программы.

## Стратегии оптимизации

В современных движках JavaScript реализованы некоторые стратегии оптимизации, позволяющие повысить производительность выполнения кода. Эти оптимизации происходят динамически во время процесса выполнения.

- **_Just-in-Time compilation_** (Точно в срок): процесс, включающий перевод кода JavaScript в машинный код, происходит с помощью компиляции и интерпретации, чтобы оптимизировать производительность веб-приложений. Это называется компиляцией Just-in-Time. Этот метод одновременно компилирует весь код в машинный код и выполняет его.

- **_Встраивание_** (Inlining): еще один метод оптимизации, который JavaScript использует для повышения производительности и скорости.

```javascript
function add(a, b) {
  return a + b;
}

let result = 0;
result = result + 5;
result = result + 3;

console.log(result); //
```

В этом фрагменте исходная `add()` функция не вызывается напрямую. Вместо этого код внутри функции return `a + b`; вставляется в место вызова.

Эта оптимизация сделана специально для функций, которые вызываются неоднократно. Движок JavaScript выполнит функцию, как обычно. Но поскольку функция вызывается часто, движок заменяет вызов функции фактическим кодом функции на месте вызова. Это помогает предотвратить несколько вызовов функций и повысить производительность.
